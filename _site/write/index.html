<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Create post</title>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/bootstrap-theme.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/translit.js"></script>
  <script src="js/save-post.js"></script>
</head>
<body>

  <div class="container">
    <h1 style="text-align: center">Write a new post</h1>
    <div class="form-horizontal">
      <div class="form-group">
        <label for="inputEmail3" class="col-sm-2 control-label">Post title</label>
        <div class="col-sm-10">
          <input type="text" class="field1 form-control" id="title">
        </div>
      </div>
      <div class="form-group">
        <label for="inputPassword3" class="col-sm-2 control-label">Post text</label>
        <div class="col-sm-10">
          <textarea id="content" rows="10" class="field2 form-control" id="inputPassword3"></textarea>
        </div>
      </div>
      <div class="form-group">
        <label for="inputPassword3" class="col-sm-2 control-label">Post category</label>
        <div class="col-sm-10">
          <select class="field3 form-control" id="category">
            <option value="life">life</option>
            <option value="web">web</option>
            <option value="news">news</option>
            <option value="thoughts">thoughts</option>
          </select>
        </div>
      </div>
      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <button id="download" class="btn btl-large btn-default"
          style="outline: none !important">Download Post File</button>
        </div>
      </div>
    </div>
  </div>

  <script>
  jQuery(document).ready(function($) {

    $('.field1').on('keydown', function (event) {
      if (event.which == 13) {
          $('.field2').focus()
          event.preventDefault();
      }
    });

    $('#download').click(function(event) {
      var d = new Date();
      var year = d.getFullYear();
      var month = ("0" + (d.getMonth() + 1)).slice(-2)
      var date = ('0' + d.getDate()).slice(-2);

      var title = $('#title').val();
      var category = $('#category').val();
      var content = $('#content').val();

      if (title == '') {
        alert('Complete title field!');
        return;
      }

      var filename = translit([year, month, date, title].join('-'));
      var file_content =
          '---\nlayout: post\ntitle: ' + title + '\ndate: ' + year + '-' + month + '-' + date + '\ncategories: ' + category +'\n---\n\n' + content;

      var blob = new Blob([file_content],
          {type: "text/plain;charset=utf-8"});

      saveAs(blob, filename + ".md");
    });

  });


  </script>
</body>
</html>